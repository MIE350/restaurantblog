package com.mie.model;

import java.util.*;

public class ReviewList {
	
	private Map map = new HashMap();

	/**
	 * Adds a review
	 * 
	 * @param newReview
	 *            - new <tt>Review</tt> to add
	 */
	public void add(Review newReview) {
		map.put(newReview.getReviewId(), newReview);
	}

	/**
	 * 
	 * @param reviewId
	 *            <tt>String</tt>
	 * @return if review with code <tt>reviewId</tt> is in the list
	 */
	public boolean has(String reviewId) {
		return map.containsKey(reviewId);
	}

	/**
	 * 
	 * @param course
	 *            <tt>Course</tt>
	 * @return if course is in the list
	 */
	public boolean has(Review review) {
		return map.containsKey(review.getReviewId());
	}

	public int size() {
		return map.size();
	}

	public Course get(String course_code) throws NotFoundException {
		if (!has(course_code)) {
			throw new NotFoundException(course_code);
		}
		return (Course) map.get(course_code);
	}

	public Iterator iterator() {
		return map.values().iterator();
	}

	public boolean insert(Course course) {

		String code = course.getCode();
		String name = course.getName();
		String qStr = "INSERT INTO Course Values ('" + code + "', '" + name + "')";
		boolean updateResult = Main.runUpdate(qStr);
		return updateResult;
	}

	public boolean insertT(Course course) {

		String code = course.getCode();
		int profId = course.getProfId();
		int taId = course.getTAId();
		String qStr = "INSERT INTO Teaches (ProfID, CrsID, TAID) Values (" 
				+ profId + ", '" + code + ", " + taId +"')";
		boolean updateResult = Main.runUpdate(qStr);
		return updateResult;
	}
	
	public boolean isEmpty() {
		return map.isEmpty();
	}
	
	public String getOutput() {
		String result = ",";
		Iterator courses = iterator();
		while (courses.hasNext()) {
			Course course = (Course) courses.next();
			String crsCode = course.getCode();
			result = result + crsCode + ",";
		}
		return result;
	}

}
